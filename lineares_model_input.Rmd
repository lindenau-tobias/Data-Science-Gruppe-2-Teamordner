---
title: "linearer_model_input"
output: html_notebook
---


#title: "linearer model input
#Ziel: model mit den master df variablen füttern
#Autor: "Tobias Lindenau"
#Datum des Erstellens: 18.01.2020


```{r}
#install.packages("Metrics")
#Bibliotheken
library(readr)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(dplyr)
library(magrittr)
library(broom)
library(Metrics)

```

Einlesen der Daten
```{r}
# master df einlesen
master_df <- read.csv("master_df.csv")

#von Merle eingefügt, damit alle NAs mit 0 ersetzt werden 
master_df[is.na(master_df)] <- 0 

master_df$Datum <- as.Date(master_df$Datum, format = "%Y-%m-%d")

#X Spalte loeschen
master_df$X<-NULL
#Monat_1 Spalte loeschen
master_df$Monat_1<-NULL

#Wochentage ausgeschrieben ranhängen 
master_df$Wochentag<-as.factor(master_df$Wochentag)
```

Ja oder Nein Variablen als as.factor setzten
```{r}

#master_df$Sonntag<-as.factor(master_df$Sonntag) (Variable rausgenommen, weil es ja schon im Wochentag ist -Merle)
#master_df$Samstag<-as.factor(master_df$Samstag)(Variable rausgenommen, weil es ja schon im Wochentag ist -Merle)
master_df$Monat<-as.factor(master_df$Monat)
master_df$Weihnachtsmarkt<-as.factor(master_df$Weihnachtsmarkt)
master_df$Ferien<-as.factor(master_df$Ferien)
master_df$weihnachtsfeiertag_25<-as.factor(master_df$weihnachtsfeiertag_25)
master_df$weihnachtsfeiertag_26<-as.factor(master_df$weihnachtsfeiertag_26)
master_df$weihnachtsfeiertag_27<-as.factor(master_df$weihnachtsfeiertag_27)
master_df$neujahrstage<-as.factor(master_df$neujahrstage)
#master_df$KielerWoche<-as.factor(master_df$KielerWoche)
master_df$Wettercode<-as.factor(master_df$Wettercode)
master_df$feiertage<-as.factor(master_df$feiertage)
master_df$Temperaturklassen<-as.factor(master_df$Temperaturklassen)
master_df$nach_feiertag<-as.factor(master_df$nach_feiertag)
master_df$vor_feiertag<-as.factor(master_df$vor_feiertag)

```

Kiwo as double
```{r}
master_df$KielerWoche<-as.double(master_df$KielerWoche)
```

Na Value mit 0 ersetzten
```{r}
master_df <- master_df %>%
    mutate(KielerWoche = if_else(is.na(KielerWoche), 0, KielerWoche))
```


Modellgleichung
```{r}
mod1 <- lm(Gesamtumsatz ~ Ware_1, master_df)
mod2 <- lm(Gesamtumsatz ~ Ware_1+ Ware_2 + Ware_3, master_df)
mod3 <- lm(Gesamtumsatz ~ Ware_1+ Ware_2 + Ware_3 + Ware_4, master_df)
mod4 <- lm(Gesamtumsatz ~ Ware_1+ Ware_2 + Ware_3 + Ware_4 + Ware_5, master_df)
mod5 <- lm(Gesamtumsatz ~ Ware_1+ Ware_2 + Ware_3 + Ware_4 + Ware_5 + Ware_6, master_df)
mod6 <- lm(Gesamtumsatz ~ Ware_1+ Ware_2 + Ware_3 + Ware_4 + Ware_5 + Ware_6 + Wochentag, master_df) #sehr kleine Verbesserung
mod7 <- lm(Gesamtumsatz ~ Ware_1+ Ware_2 + Ware_3 + Ware_4 + Ware_5 + Ware_6 + Wochentag + Ferien, master_df) #Sehr kleine Verschlechterung


summary(mod1)

```

```{r}
# Preparation of Model Results
rbind(glance(mod1), glance(mod2), glance(mod3), glance(mod4), glance(mod5), glance(mod6), glance(mod7))
```
```


modelle plotten
```{r}
lmTemp = lm(Pressure~Temperature, data = pressure) #Create the linear regression
plot(pressure, pch = 16, col = "blue") #Plot the results
abline(lmTemp) #Add a regression line
```


```{r}
mod1 <- lm(Gesamtumsatz ~ Wochentag + Sonntag + Samstag + Monat + Weihnachtsmarkt + Ferien + Monat + Ware_1 + Ware_2 + Ware_3 + Ware_4 + Ware_5 + Ware_6 + weihnachtsfeiertag_25 + weihnachtsfeiertag_26 + weihnachtsfeiertag_27 + neujahrstage + KielerWoche, master_df)
summary(mod1)
```

