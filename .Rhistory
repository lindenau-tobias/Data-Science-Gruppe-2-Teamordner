mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(sum_monatstage, aes(x=monatstag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
ylab("Durchschnitt (€)")
ggplot(sum_monatstage, aes(x=monatstag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
ylab("Durchschnitt (€)")+
ggtitle("Umsatz im Monatsverlauf")
ggplot(sum_monatstage, aes(x=monatstag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
xlab ("Tage im Monat")+
ylab("Durchschnitt (€)")+
ggtitle("Umsatz im Monatsverlauf")
?xlim
ggplot(ware_monatstage, aes(x=monatstag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Monatstag")
ggcorr(sum_monatstage, method = c("everything", "pearson"))
library(GGally)
ggcorr(sum_monatstage, method = c("everything", "pearson"))
?ggcorr
ggcorr(sum_monatstage, method = c("pairwise", "pearson"))
View(sum_monatstage)
#Monatstage und Umsatzfiltern
gefilterte_sum_monatstage<-filter(sum_monatstage, monatstag, mean)
library(GGally)
ggcorr(gefilterte_sum_monatstage, method = c("everything", "pearson"))
View(gefilterte_sum_monatstage)
install.packages("ggridges")
#Balkendiagramm der Summe Umsätze je Jahr(ohne Konfidenzintervall)
ggplot(ware_jahr) +
geom_bar( aes(x=Warengruppe, y=summe), stat="identity") +
ylab("Summe(€)")+
facet_wrap(~jahr)+
ggtitle("Summe der  Warengruppe in den Jahren")
ggplot(ware_monatstage, aes(x=monatstag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Monatstag")
ggplot(ware_jahr, aes(x=jahr, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Jahr")
ggplot(ware_jahr, aes(x=jahr, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
xlab ("Jahre")+
ylab("Durchschnitt (€)")+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Jahr")
library(readr)
library(readr)
library(tidyverse)
library(readr)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(dplyr)
umsatz <- read_csv("umsatzdaten_gekuerzt.csv",
col_types = cols(Datum = col_datetime(format = " %Y-%m-%d   "))) #Eingeben des Datums
#Erstellung der Variable mit Jahr
umsatz$jahr <- year(umsatz$Datum)
#Tabelle für den Umsatz nach Warengruppen  und Jahren
ware_jahr<- umsatz %>%
group_by(jahr, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
# nach Warengruppe nach Jahren den Umsatz plotten
ggplot(ware_jahr) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~jahr)+
ggtitle("Umsatz nach Warengruppe und Jahr")
#Balkendiagramm der Summe Umsätze je Jahr(ohne Konfidenzintervall)
ggplot(ware_jahr) +
geom_bar( aes(x=Warengruppe, y=summe), stat="identity") +
ylab("Summe(€)")+
facet_wrap(~jahr)+
ggtitle("Summe der  Warengruppe in den Jahren")
ggplot(ware_jahr, aes(x=jahr, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
xlab ("Jahr")+
ylab("Durchschnitt (€)")+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Jahr")
umsatz$monatstag<- mday(umsatz$Datum)
sum_monatstage<- umsatz %>%
group_by(monatstag) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(sum_monatstage, aes(x=monatstag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
xlab ("Tage im Monat")+
ylab("Durchschnitt (€)")+
ggtitle("Umsatz im Monatsverlauf")
ware_monatstage<- umsatz %>%
group_by(monatstag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(ware_monatstage, aes(x=monatstag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Monatstag")
View(ware_jahr)
View(sum_monatstage)
View(ware_jahr)
View(sum_monatstage)
View(ware_monatstage)
View(sum_monatstage)
#Summe der Jahre bilden
sum_jahre<- umsatz %>%
group_by(jahr) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(sum_jahre)
#nach Tag zusammenfassen
umsatz$tag <- day(umsatz$Datum)
#Summe der Jahre bilden
sum_jahre<- umsatz %>%
group_by(day) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
#Summe der Jahre bilden
sum_jahre<- umsatz %>%
group_by(tag) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
#Summe der Jahre bilden
sum_tage<- umsatz %>%
group_by(tag) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(sum_tage, aes(x=jahre, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
xlab ("Tage im Monat")+
ylab("Durchschnitt (€)")+
ggtitle("Umsatz im Monatsverlauf")
#nach Tag zusammenfassen
umsatz$tag <- day(umsatz$Datum)
#Summe der Jahre bilden
sum_tag<- umsatz %>%
group_by(tag) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(sum_tage, aes(x=tag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
ggtitle("Umsatz über den gesamten Zeitraum")
ggplot(sum_tage, aes(x=tag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
ggtitle("Umsatz über den gesamten Zeitraum")
View(sum_tag)
#nach Tag zusammenfassen
umsatz$tag <- date(umsatz$Datum)
#Summe der Jahre bilden
sum_tag<- umsatz %>%
group_by(tag) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(sum_tage, aes(x=tag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
ggtitle("Umsatz über den gesamten Zeitraum")
View(umsatz)
#Summe der Jahre bilden
sum_tag<- umsatz %>%
group_by(Datum) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(sum_tag, aes(x=Datum, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
ggtitle("Umsatz über den gesamten Zeitraum")
ggplot(sum_tag, aes(x=Datum, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
xlab("Jahr")+
ylab("Durschnittlicher Umsatz (€)")
ggplot(sum_tag, aes(x=Datum, y=summe)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")
ggplot(sum_tag, aes(x=Datum, y=summe)) +
geom_point() +
xlab("Jahr")+
ylab("Summe Umsatz (€)")
ggplot(sum_tag, aes(x=Datum, y=summe)) +
geom_point() +
xlab("Jahr")+
ylab("Summe Umsatz (€)")
View(sum_tag)
ggplot(sum_tag, aes(x=Datum, y=summe)) +
geom_point() +
geom_label(
data=sum_tag %>% filter(summe>=2000), # Filter data first
aes(label=Datum)
)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")
ggplot(sum_tag, aes(x=Datum, y=summe)) +
geom_point() +
geom_smooth(method=lm , color="red", se=FALSE) +
geom_label(
data=sum_tag %>% filter(summe>=2000), # Filter data first
aes(label=Datum)
)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")
ggplot(umsatz, aes(x=Datum, y=summe)) +
geom_point() +
geom_smooth(method=lm , color="red", se=FALSE) +
facet_wrap(~Warengruppe)
View(umsatz)
ggplot(umsatz, aes(x=Datum, y=Umsatz)) +
geom_point() +
geom_smooth(method=lm , color="red", se=FALSE) +
facet_wrap(~Warengruppe)
ggplot(umsatz, aes(x=Datum, y=Umsatz)) +
geom_point() +
geom_smooth(method=lm , color="red", se=FALSE) +
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")
ggplot(umsatz, aes(x=Datum, y=Umsatz)) +
geom_point() +
#geom_smooth(method=lm , color="red", se=FALSE) +
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")
#Monat an den Datensatz heranhängen
umsatz$monat<- month(umsatz$Datum)
#Monat an den Datensatz heranhängen
umsatz$monat<- month(umsatz$Datum)
#den Umsatz nach den Monaten filtern
ware_monat<- umsatz %>%
group_by(monat, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_monat)
geom_label(
data=data %>% filter(jahr>2 & wt>3), # Filter data first
aes(label=carName)+
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")
ggtitle("Umsatz über den gesamten Zeitraum nach Warengruppen")+
geom_label(
data=data %>% filter(jahr>2 & wt>3), # Filter data first
aes(label=carName)+
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")
ggtitle("Umsatz über den gesamten Zeitraum nach Warengruppen")+
geom_label(
data=data %>% filter(jahr>2 & wt>3), # Filter data first
aes(label=carName)+
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")+
ggtitle("Umsatz über den gesamten Zeitraum nach Warengruppen")+
ggplot(ware_jahr, aes(x=jahr, y=mean)) +
ggplot(ware_jahr, aes(x=jahr, y=mean)) +
geom_label(
data=data %>% filter(jahr>2 & wt>3), # Filter data first
aes(label=carName)+
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")+
ggtitle("Umsatz über den gesamten Zeitraum nach Warengruppen")+
ggplot(umsatz, aes(x=Datum, y=Umsatz)) +
ggplot(umsatz, aes(x=Datum, y=Umsatz)) +
geom_point() +
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")+
ggtitle("Umsatz über den gesamten Zeitraum nach Warengruppen")
ggplot(umsatz, aes(x=Datum, y=Umsatz)) +
ggplot(umsatz, aes(x=Datum, y=Umsatz)) +
geom_point() +
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")+
ggtitle ("Umsatz über den gesamten Zeitraum nach Warengruppen")
#den Umsatz nach den Monaten filtern
ware_monat<- umsatz %>%
group_by(monat, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1)))
#den Umsatz nach den Monaten filtern
ware_monat<- umsatz %>%
group_by(monat, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_monat)
# nach Warengruppe in den unterschiedlichen Monaten den Umsatz plotten (Scatterplot)
ggplot(ware_monat, aes(x=monat, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Monat")
# nach Warengruppe in den unterschiedlichen Monaten den Umsatz plotten (Scatterplot)
ggplot(ware_monat, aes(x=monat, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
facet_wrap(~Warengruppe)+
xlab("Monat")+
ylab("Durchschnittlicher Umsatz (€)")
library(readr)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(dplyr)
umsatz <- read_csv("umsatzdaten_gekuerzt.csv",
col_types = cols(Datum = col_datetime(format = " %Y-%m-%d   "))) #Eingeben des Datums
#Erstellung der Variable mit Jahr
umsatz$jahr <- year(umsatz$Datum)
#Tabelle für den Umsatz nach Warengruppen  und Jahren
ware_jahr<- umsatz %>%
group_by(jahr, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
# nach Warengruppe nach Jahren den Umsatz plotten
ggplot(ware_jahr) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~jahr)+
ggtitle("Umsatz nach Warengruppe und Jahr")
#Summe der Jahre bilden
sum_tag<- umsatz %>%
group_by(Datum) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(sum_tag, aes(x=Datum, y=summe)) +
geom_point() +
geom_smooth(method=lm , color="red", se=FALSE) +
geom_label(
data=sum_tag %>% filter(summe>=2000), # alles mit einer Summe ab 2000€ gelabelt
aes(label=Datum)
)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")
ggplot(umsatz, aes(x=Datum, y=Umsatz)) +
geom_point() +
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")+
ggtitle ("Umsatz über den gesamten Zeitraum nach Warengruppen")
#Balkendiagramm der Summe Umsätze je Jahr(ohne Konfidenzintervall)
ggplot(ware_jahr) +
geom_bar( aes(x=Warengruppe, y=summe), stat="identity") +
ylab("Summe(€)")+
facet_wrap(~jahr)+
ggtitle("Summe der  Warengruppe in den Jahren")
ggplot(ware_jahr, aes(x=jahr, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
xlab ("Jahr")+
ylab("Durchschnitt (€)")+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Jahr")
umsatz$monatstag<- mday(umsatz$Datum)
sum_monatstage<- umsatz %>%
group_by(monatstag) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(sum_monatstage, aes(x=monatstag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
xlab ("Tage im Monat")+
ylab("Durchschnitt (€)")+
ggtitle("Umsatz im Monatsverlauf")
```{r}
ware_monatstage<- umsatz %>%
group_by(monatstag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(ware_monatstage, aes(x=monatstag, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Monatstag")
#Monat an den Datensatz heranhängen
umsatz$monat<- month(umsatz$Datum)
#den Umsatz nach den Monaten filtern
ware_monat<- umsatz %>%
group_by(monat, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
# nach Warengruppe in den unterschiedlichen Monaten den Umsatz plotten (Scatterplot)
ggplot(ware_monat, aes(x=monat, y=mean)) +
geom_point() +
geom_smooth(method=lm , color="red", fill="#69b3a2", se=TRUE)+
facet_wrap(~Warengruppe)+
xlab("Monat")+
ylab("Durchschnittlicher Umsatz (€)")
library(readr)
library(readr)
library(tidyverse)
library(lubridate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(dplyr)
umsatz <- read_csv("umsatzdaten_gekuerzt.csv",
col_types = cols(Datum = col_datetime(format = " %Y-%m-%d   "))) #Eingeben des Datums
View(umsatz)
