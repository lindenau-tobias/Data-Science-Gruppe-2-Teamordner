plot(merge_um_wet$Temperatur , merge_um_wet$Umsatz,  main="" , pch=20 , cex=0.4 , col=rgb(0.3,0.5,1,0.4)  , xlab="Temperatur" , ylab="Umsatz" )
install.packages("readr")
install.packages("tidyverse")
install.packages("lubridate", "ggplot2", "dplyr")
install.packages(c("lubridate", "ggplot2", "dplyr"))
umsatz <- read_csv("umsatzdaten_gekuerzt.csv",
col_types = cols(Datum = col_datetime(format = " %Y-%m-%d   "))) #Eingeben des Datums
umsatz <- readr("umsatzdaten_gekuerzt.csv",
col_types = cols(Datum = col_datetime(format = " %Y-%m-%d   "))) #Eingeben des Datums
library(readr)
library(tidyverse)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(dplyr)
umsatz$wochentag <- weekdays(umsatz$Datum)
#Tage ordnen
umsatz$wochentag <- factor(umsatz$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
umsatz <- read_csv("umsatzdaten_gekuerzt.csv",
col_types = cols(Datum = col_datetime(format = " %Y-%m-%d   "))) #Eingeben des Datums
umsatz$wochentag <- weekdays(umsatz$Datum)
#Tage ordnen
umsatz$wochentag <- factor(umsatz$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
umsatz[order(umsatz$wochentag), ]
ggplot(umsatz) +
geom_bar(aes(x = wochentag, y = Umsatz), stat = "identity")
ggplot(umsatz) +
geom_bar(aes(x = wochentag, y = Umsatz), stat = "identity")
#Balkendiagramm der Umsätze aller Warengruppen je Wochentag (ohne Konfidenzintervall)
# Berechnung von Mittelwerten, Standardabweichungen, Standardfehlern und Konfidenzintervallen
#n ist einfach nur praktisch und z?hlt die Wochentage
my_sum_week<- umsatz %>%
group_by(wochentag) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
# Confidence Interval
ggplot(my_sum_week) +
geom_bar( aes(x=wochentag, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=wochentag, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
xlab("Wochentag")+
ylab("Durschnitt (€)")+
ggtitle("Durchschnittlicher Umsatz in der Woche über alle Warengruppen")
```{r}
#Tage ordnen
ware_week$wochentag <- factor(ware_week$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
ware_week[order(ware_week$wochentag), ]
# nach Warengruppe an den Wochentagen den Umsatz plotten
ggplot(ware_week) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~wochentag)+
ggtitle("Umsatz nach Warengruppe und Wochentag")
für weitere Analyse müssen erst die ganzen Feiertage etc. rausgenommen werden
install.packages(c("dplyr", "ggplot2", "lubridate", "readr", "tidyverse"))
install.packages(c("dplyr", "ggplot2", "lubridate", "readr", "tidyverse"))
install.packages(c("dplyr", "ggplot2", "lubridate", "readr", "tidyverse"))
install.packages(c("dplyr", "ggplot2", "lubridate", "readr", "tidyverse"))
install.packages(c("dplyr", "ggplot2", "lubridate", "readr", "tidyverse"))
install.packages(c("dplyr", "ggplot2", "lubridate", "readr", "tidyverse"))
library(readr)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(dplyr)
umsatz <- read_csv("umsatzdaten_gekuerzt.csv",
col_types = cols(Datum = col_datetime(format = " %Y-%m-%d   "))) #Eingeben des Datums
umsatz$wochentag <- weekdays(umsatz$Datum)
#Tage ordnen
umsatz$wochentag <- factor(umsatz$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
umsatz[order(umsatz$wochentag), ]
ggplot(umsatz) +
geom_bar(aes(x = wochentag, y = Umsatz), stat = "identity")
#Balkendiagramm der Umsätze aller Warengruppen je Wochentag (ohne Konfidenzintervall)
# Berechnung von Mittelwerten, Standardabweichungen, Standardfehlern und Konfidenzintervallen
#n ist einfach nur praktisch und z?hlt die Wochentage
my_sum_week<- umsatz %>%
group_by(wochentag) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
# Confidence Interval
ggplot(my_sum_week) +
geom_bar( aes(x=wochentag, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=wochentag, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
xlab("Wochentag")+
ylab("Durschnitt (€)")+
ggtitle("Durchschnittlicher Umsatz in der Woche über alle Warengruppen")
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen
ware_week<- umsatz %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
#Tage ordnen
ware_week$wochentag <- factor(ware_week$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
ware_week[order(ware_week$wochentag), ]
# nach Warengruppe an den Wochentagen den Umsatz plotten
ggplot(ware_week) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~wochentag)+
ggtitle("Umsatz nach Warengruppe und Wochentag")
#Summe der Jahre bilden
sum_tag<- umsatz %>%
group_by(Datum) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
ggplot(sum_tag, aes(x=Datum, y=summe)) +
geom_point() +
geom_smooth(method=lm , color="red", se=FALSE) +
geom_label(
data=sum_tag %>% filter(summe>=2000), # alles mit einer Summe ab 2000€ gelabelt
aes(label=Datum)
)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")
ggtitle("Umsatz über den gesamten Zeitraum")
ggplot(umsatz, aes(x=Datum, y=Umsatz)) +
geom_point() +
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")+
ggtitle ("Umsatz über den gesamten Zeitraum nach Warengruppen")
library(readr)
Variablen <- read_delim("Variablen.csv",
";", escape_double = FALSE, trim_ws = TRUE)
View(Variablen)
Feiertage <- read_delim("Variablen.csv",
";", escape_double = FALSE, trim_ws = TRUE)
View(ware_week)
?filter
Warengruppe6<- filter(ware_week, Warengruppe== 6)
View(umsatz)
Warengruppe5_ü1000 <- filter(umsatz, Warengruppe== 5, Umsatz>=1000)
View(Warengruppe5_ü1000)
Warengruppe5_ue1000 <- filter(umsatz, Warengruppe== 5, Umsatz >= 1000)
View(Warengruppe5_ü1000)
# nach Warengruppe an den Wochentagen den Umsatz plotten
ggplot(umsatz, aes(x=Datum, y=Umsatz)) +
geom_point() +
facet_wrap(~Warengruppe)+
xlab("Jahr")+
ylab("Summe Umsatz (€)")+
ggtitle ("Umsatz über den gesamten Zeitraum nach Warengruppen")
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
group_by(wochentag, Warengruppe) %>%
filter(Warengruppe == 6 & Warengruppe== 5, Umsatz >= 1000) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_ohne6_5gr1000)
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
group_by(wochentag, Warengruppe) %>%
filter(Warengruppe == 6 )%>%
filter(Warengruppe== 5, Umsatz >= 1000) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
group_by(wochentag, Warengruppe) %>%
filter(!Warengruppe == 6 )%>%
filter(!Warengruppe== 5, Umsatz >= 1000) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_ohne6_5gr1000)
ware_ohne6_5gr1000<-umsatz(!Warengruppe6, Warengruppe5_ue1000)
Warengruppe_ohne6_5ue1000 <- !filter(umsatz, Warengruppe== 6 & Warengruppe== 5, Umsatz >= 1000)
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter(Warengruppe!= 5, Umsatz >= !1000) %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_ohne6_5gr1000)
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter(Warengruppe == 5, Umsatz >= !1000) %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_ohne6_5gr1000)
Warengruppe_ohne6_5ue1000 <- filter( Warengruppe== 5, Umsatz >= 1000)
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter(Warengruppe == 5 & Umsatz >= !1000) %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_ohne6_5gr1000)
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter(Warengruppe != 5 & Umsatz >= !1000) %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_ohne6_5gr1000)
Warengruppe_ohne6_5ue1000 <- filter( umsatz, Warengruppe== 5 & Umsatz >= 1000)
Warengruppe5 <- filter( umsatz, Warengruppe== 5 & Umsatz >= 1000)
View(Warengruppe5)
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter(Warengruppe != 5 & Umsatz >= 1000) %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_ohne6_5gr1000)
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter(Warengruppe != 5 & Umsatz >= 1000) %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter(Warengruppe == 5 & Umsatz >= 1000) %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_ohne6_5gr1000)
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter!(Warengruppe == 5 & Umsatz >= 1000) %>%
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter(!(Warengruppe == 5 & Umsatz >= 1000)) %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
View(ware_ohne6_5gr1000)
#Tage ordnen
ware_ohne6_5gr1000$wochentag <- factor(ware_week$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
ware_ohne6_5gr1000
ware_ohne6_5gr1000
ware_ohne6_5gr1000[order(ware_ohne6_5gr1000$wochentag), ]
# nach Warengruppe an den Wochentagen den Umsatz plotten (ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro)
ggplot(ware_ohne6_5gr1000) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~wochentag)+
ggtitle("Umsatz nach Warengruppe und Wochentag", subtitle = "ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro, sind auch aus den Standardabweichungen, Durchschnitten etc. entfernt")
# nach Warengruppe an den Wochentagen den Umsatz plotten (ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro)
ggplot(ware_ohne6_5gr1000) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~wochentag)+
ggtitle("Umsatz nach Warengruppe und Wochentag", caption = "ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro, sind auch aus den Standardabweichungen, Durchschnitten etc. entfernt")
# nach Warengruppe an den Wochentagen den Umsatz plotten (ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro)
ggplot(ware_ohne6_5gr1000) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~wochentag)+
ggtitle("Umsatz nach Warengruppe und Wochentag")+
labs(caption = "ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro, sind auch aus den Standardabweichungen, Durchschnitten etc. entfernt")
# nach Warengruppe an den Wochentagen den Umsatz plotten (ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro)
ggplot(ware_ohne6_5gr1000) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
labels=c("1 (Brot)", "2 (Brötchen)", "3 (Crossant)", "4( Konditorei)", "5 (Kuchen)")
# nach Warengruppe an den Wochentagen den Umsatz plotten (ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro)
ggplot(ware_ohne6_5gr1000) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
labels=c("1 (Brot)", "2 (Brötchen)", "3 (Crossant)", "4( Konditorei)", "5 (Kuchen)")+
ylab("Durchschnitt (€)")+
facet_wrap(~wochentag)+
ggtitle("Umsatz nach Warengruppe und Wochentag")+
labs(caption = "ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro, sind auch aus den Standardabweichungen, Durchschnitten etc. entfernt")
# nach Warengruppe an den Wochentagen den Umsatz plotten (ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro)
ggplot(ware_ohne6_5gr1000) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~wochentag)+
ggtitle("Umsatz nach Warengruppe und Wochentag")+
labs(caption = "ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro, sind auch aus den Standardabweichungen, Durchschnitten etc. entfernt")
# nach Warengruppe an den Wochentagen den Umsatz plotten (ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro)
ggplot(ware_ohne6_5gr1000) +
geom_bar( aes(x=wochentag, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Wochentag")+
labs(caption = "ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro, sind auch aus den Standardabweichungen, Durchschnitten etc. entfernt")
umsatz <- read_csv("umsatzdaten_gekuerzt.csv",
col_types = cols(Datum = col_datetime(format = " %Y-%m-%d   "))) #Eingeben des Datums
umsatz$wochentag <- weekdays(umsatz$Datum)
#Tage ordnen
umsatz$wochentag <- factor(umsatz$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
umsatz[order(umsatz$wochentag), ]
ggplot(umsatz) +
geom_bar(aes(x = wochentag, y = Umsatz), stat = "identity")
#Balkendiagramm der Umsätze aller Warengruppen je Wochentag (ohne Konfidenzintervall)
# Berechnung von Mittelwerten, Standardabweichungen, Standardfehlern und Konfidenzintervallen
#n ist einfach nur praktisch und z?hlt die Wochentage
my_sum_week<- umsatz %>%
group_by(wochentag) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
# Confidence Interval
ggplot(my_sum_week) +
geom_bar( aes(x=wochentag, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=wochentag, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
xlab("Wochentag")+
ylab("Durschnitt (€)")+
ggtitle("Durchschnittlicher Umsatz in der Woche über alle Warengruppen")
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen
ware_week<- umsatz %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
#Tage ordnen
ware_week$wochentag <- factor(ware_week$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
ware_week[order(ware_week$wochentag), ]
# nach Warengruppe an den Wochentagen den Umsatz plotten
ggplot(ware_week) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~wochentag)+
ggtitle("Umsatz nach Warengruppe und Wochentag")
ggplot(ware_week) +
geom_bar( aes(x=wochentag, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Wochentag")
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter(!(Warengruppe == 5 & Umsatz >= 1000)) %>%   #alles rausgefiltert wo 5 mehr Umsatz als 1000 Euro hat
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
#Tage ordnen
ware_ohne6_5gr1000$wochentag <- factor(ware_ohne6_5gr1000$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
ware_ohne6_5gr1000[order(ware_ohne6_5gr1000$wochentag), ]
# nach Warengruppe an den Wochentagen den Umsatz plotten (ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro)
ggplot(ware_ohne6_5gr1000) +
geom_bar( aes(x=wochentag, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Wochentag")+
labs(caption = "ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro, sind auch aus den Standardabweichungen, Durchschnitten etc. entfernt")
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen
ware_week<- umsatz %>%
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
#Tage ordnen
ware_week$wochentag <- factor(ware_week$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
ware_week[order(ware_week$wochentag), ]
# nach Warengruppe an den Wochentagen den Umsatz plotten
ggplot(ware_week) +
geom_bar( aes(x=Warengruppe, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~wochentag)+
ggtitle("Umsatz nach Warengruppe und Wochentag", subtitle = "Mit warengruppe 6 und allen Werten von Warengruppe 5")
ggplot(ware_week) +
geom_bar( aes(x=wochentag, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Wochentag", subtitle = "Mit warengruppe 6 und allen Werten von Warengruppe 5")
#Tabelle für den Umsatz nach Warengruppen  und  Wochentagen (ohne Warengruppe 6 und Werte von Warengruppe 5 über 1000€)
ware_ohne6_5gr1000<- umsatz %>%
filter(Warengruppe != 6)  %>%
filter(!(Warengruppe == 5 & Umsatz >= 1000)) %>%   #alles rausgefiltert wo 5 mehr Umsatz als 1000 Euro hat
group_by(wochentag, Warengruppe) %>%
summarise(
n=n(), #ist praktisch, weil es die Anzahl z?hlt
mean=mean(Umsatz),
sd=sd(Umsatz),
summe=sum(Umsatz)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
#Tage ordnen
ware_ohne6_5gr1000$wochentag <- factor(ware_ohne6_5gr1000$wochentag , levels= c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"))
ware_ohne6_5gr1000[order(ware_ohne6_5gr1000$wochentag), ]
# nach Warengruppe an den Wochentagen den Umsatz plotten (ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro)
ggplot(ware_ohne6_5gr1000) +
geom_bar( aes(x=wochentag, y=mean), stat="identity", fill="forestgreen", alpha=0.5) +
geom_errorbar( aes(x=Warengruppe, ymin=mean-ic, ymax=mean+ic), width=0.4, colour="orange", alpha=0.9, size=1.5) +
ylab("Durchschnitt (€)")+
facet_wrap(~Warengruppe)+
ggtitle("Umsatz nach Warengruppe und Wochentag")+
labs(caption = "ohne Warengruppe 6 und Warengruppe 5 über 1000 Euro, sind auch aus den Standardabweichungen, Durchschnitten etc. entfernt")
